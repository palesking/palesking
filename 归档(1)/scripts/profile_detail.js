(function(){var t,e,r=function(t,e){return function(){return t.apply(e,arguments)}},o=function(t,e){function r(){this.constructor=t}for(var o in e)s.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},s={}.hasOwnProperty;t=function(t){function e(){this.discard=r(this.discard,this),this.save=r(this.save,this),this.switchAuth=r(this.switchAuth,this),this.deleteProfile=r(this.deleteProfile,this),this.switchProxyType=r(this.switchProxyType,this),this.render=r(this.render,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.events={"click .detail_delete_button":"deleteProfile","click .detail_save_button":"save","click .detail_cancel_button":"discard","click .proxy_type_button_group a":"switchProxyType","click .auth_proxy_toggle":"switchAuth"},e.prototype.elements={".action_id":"actionId",".proxy_name_entry":"proxyNameEntry",".proxy_type_button_group":"proxyTypeButtonGroup",".pac_url_entry":"pacUrlEntry",".scheme_combo":"schemeCombo",".host_entry":"hostEntry",".port_entry":"portEntry",".bypass_entry":"bypassEntry",".auth_proxy_toggle":"authToggle",".auth_proxy_block":"authBlock",".username_entry":"usernameEntry",".password_entry":"passwordEntry",".detail_delete_button":"deleteButton"},e.prototype.render=function(){return this.el.empty()},e.prototype.switchProxyType=function(t){var e;return e=this.getProxyType(),this.el.find(".block").hide(),this.el.find("."+e+"_proxy_block").show()},e.prototype.getProxyType=function(){return this.proxyTypeButtonGroup.find(".selected").attr("href").substring(1)},e.prototype.deleteProfile=function(t){var e,r;return e=this.proxyNameEntry.val(),r=Profile.getByName(e),0!==r.length?(r=r[0],Profile.destroy(r.id),this.hide(),app.profileList.show()):void 0},e.prototype.switchAuth=function(t){return this.authToggle.prop("checked")?this.authBlock.show():this.authBlock.hide()},e.prototype.save=function(t){var e,r,o,s;if(e=this.actionId.val(),s=null,"add"===e)s=new Profile,s.name=$.trim(this.proxyNameEntry.val()),s.selected=!1,s.testlink="";else{if(o=$.trim(this.proxyNameEntry.val()),s=Profile.getByName(o),0===s.length)return void Logging.error("Error: no such a profile named `"+o+"`");s=s[0]}return s.type=this.getProxyType(),s.scheme=this.schemeCombo.val(),s.pac_url=$.trim(this.pacUrlEntry.val()),s.host=$.trim(this.hostEntry.val()),s.port=$.trim(this.portEntry.val()),r=$.trim(this.bypassEntry.val()),0===r.length?s.bypass=[]:s.bypass=r.split(",").map(function(t){return t.trim()}),s.use_auth=$(".auth_proxy_toggle").prop("checked"),s.username=$.trim(this.usernameEntry.val()),s.password=this.passwordEntry.val(),s.save(),localStorage.getItem("selected")===s.name&&app.state&&Agent.enable(s.name),this.hide(),app.profileList.show()},e.prototype.discard=function(){return this.hide(),app.profileList.show()},e.prototype.setProfile=function(t){return this.el.find(".block").hide(),this.el.find("."+t.type+"_proxy_block").show(),this.actionId.val("edit"),this.deleteButton.css("visibility","visible"),this.proxyNameEntry.val(t.name).prop("disabled",!0),this.proxyTypeButtonGroup.find(".selected").removeClass("selected"),this.proxyTypeButtonGroup.find("a[href=#"+t.type+"]").addClass("selected"),this.schemeCombo.val(t.scheme),this.pacUrlEntry.val(t.pac_url),this.hostEntry.val(t.host),this.portEntry.val(t.port),this.authToggle.attr("checked",t.use_auth),this.authToggle.prop("checked",t.use_auth),t.use_auth?this.authBlock.show():this.authBlock.hide(),this.bypassEntry.val(t.bypass),this.usernameEntry.val(t.username),this.passwordEntry.val(t.password)},e.prototype.reset=function(){return this.el.find(".block").hide(),this.el.find(".off_proxy_block").show(),this.actionId.val("add"),this.deleteButton.css("visibility","hidden"),this.proxyNameEntry.val("").prop("disabled",!1),this.proxyTypeButtonGroup.find("a[href=off]").addClass("selected"),this.pacUrlEntry.val(""),this.hostEntry.val(""),this.portEntry.val(""),this.authToggle.attr("checked",!1).prop("checked",!1),this.authBlock.hide(),this.bypassEntry.val("<local>"),this.usernameEntry.val(""),this.passwordEntry.val("")},e.prototype.toggleAuth=function(t){return this.authToggle.prop("checked")?this.authBlock.show():this.authBlock.hide()},e.prototype.show=function(){return this.el.show()},e.prototype.hide=function(){return this.el.hide()},e}(Spine.Controller),e="undefined"!=typeof exports&&null!==exports?exports:this,e.ProfileDetail=t}).call(this);