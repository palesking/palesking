(function(){var t,r,e,n,i,s,o,u,c,h,a,l,p=Array.prototype.slice,f=Array.prototype.indexOf||function(t){for(var r=0,e=this.length;e>r;r++)if(this[r]===t)return r;return-1},d=function(t,r){return function(){return t.apply(r,arguments)}},g=Object.prototype.hasOwnProperty,y=function(t,r){function e(){this.constructor=t}for(var n in r)g.call(r,n)&&(t[n]=r[n]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t};e={bind:function(t,r){var e,n,i,s,o;for(n=t.split(" "),e=this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={}),s=0,o=n.length;o>s;s++)i=n[s],e[i]||(e[i]=[]),e[i].push(r);return this},one:function(t,r){return this.bind(t,function(){return this.unbind(t,arguments.callee),r.apply(this,arguments)})},trigger:function(){var t,r,e,n,i,s,o;if(t=1<=arguments.length?p.call(arguments,0):[],e=t.shift(),n=this.hasOwnProperty("_callbacks")&&(null!=(o=this._callbacks)?o[e]:void 0),!n)return!1;for(i=0,s=n.length;s>i&&(r=n[i],r.apply(this,t)!==!1);i++);return!0},unbind:function(t,r){var e,n,i,s,o;if(!t)return this._callbacks={},this;if(i=null!=(o=this._callbacks)?o[t]:void 0,!i)return this;if(!r)return delete this._callbacks[t],this;for(n=0,s=i.length;s>n;n++)if(e=i[n],e===r){i=i.slice(),i.splice(n,1),this._callbacks[t]=i;break}return this}},n={trace:!0,logPrefix:"(App)",log:function(){var t;return t=1<=arguments.length?p.call(arguments,0):[],this.trace&&"undefined"!=typeof console?(this.logPrefix&&t.unshift(this.logPrefix),console.log.apply(console,t),this):void 0}},l=["included","extended"],s=function(){function t(){"function"==typeof this.init&&this.init.apply(this,arguments)}return t.include=function(t){var r,e,n;if(!t)throw"include(obj) requires obj";for(e in t)n=t[e],f.call(l,e)<0&&(this.prototype[e]=n);return r=t.included,r&&r.apply(this),this},t.extend=function(t){var r,e,n;if(!t)throw"extend(obj) requires obj";for(e in t)n=t[e],f.call(l,e)<0&&(this[e]=n);return r=t.extended,r&&r.apply(this),this},t.proxy=function(t){return d(function(){return t.apply(this,arguments)},this)},t.prototype.proxy=function(t){return d(function(){return t.apply(this,arguments)},this)},t}(),i=function(){function r(t){r.__super__.constructor.apply(this,arguments),this.ids=[],t&&this.load(t)}return y(r,s),r.extend(e),r.records={},r.attributes=[],r.configure=function(){var t,r;return r=arguments[0],t=2<=arguments.length?p.call(arguments,1):[],this.className=r,this.records={},t.length&&(this.attributes=t),this.attributes&&(this.attributes=a(this.attributes)),this.attributes||(this.attributes=[]),this.unbind(),this},r.toString=function(){return""+this.className+"("+this.attributes.join(", ")+")"},r.find=function(t){var r;if(r=this.records[t],!r)throw"Unknown record";return r.clone()},r.exists=function(t){try{return this.find(t)}catch(r){return!1}},r.refresh=function(t,r){var e,n,i,s;for(null==r&&(r={}),r.clear&&(this.records={}),n=this.fromJSON(t),c(n)||(n=[n]),i=0,s=n.length;s>i;i++)e=n[i],e.newRecord=!1,e.id||(e.id=u()),this.records[e.id]=e;return this.trigger("refresh",!r.clear&&n),this},r.select=function(t){var r,e,n;return n=function(){var n,i;n=this.records,i=[];for(r in n)e=n[r],t(e)&&i.push(e);return i}.call(this),this.cloneArray(n)},r.findByAttribute=function(t,r){var e,n,i;i=this.records;for(e in i)if(n=i[e],n[t]===r)return n.clone();return null},r.findAllByAttribute=function(t,r){return this.select(function(e){return e[t]===r})},r.each=function(t){var r,e,n,i;n=this.records,i=[];for(r in n)e=n[r],i.push(t(e.clone()));return i},r.all=function(){return this.cloneArray(this.recordsValues())},r.first=function(){var t;return t=this.recordsValues()[0],null!=t?t.clone():void 0},r.last=function(){var t,r;return r=this.recordsValues(),t=r[r.length-1],null!=t?t.clone():void 0},r.count=function(){return this.recordsValues().length},r.deleteAll=function(){var t,r,e,n;e=this.records,n=[];for(t in e)r=e[t],n.push(delete this.records[t]);return n},r.destroyAll=function(){var t,r,e,n;e=this.records,n=[];for(t in e)r=e[t],n.push(this.records[t].destroy());return n},r.update=function(t,r){return this.find(t).updateAttributes(r)},r.create=function(t){var r;return r=new this(t),r.save()},r.destroy=function(t){return this.find(t).destroy()},r.change=function(t){return"function"==typeof t?this.bind("change",t):this.trigger("change",t)},r.fetch=function(t){return"function"==typeof t?this.bind("fetch",t):this.trigger("fetch",t)},r.toJSON=function(){return this.recordsValues()},r.fromJSON=function(t){var r,e,n,i;if(t){if("string"==typeof t&&(t=JSON.parse(t)),c(t)){for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(new this(r));return i}return new this(t)}},r.fromForm=function(){var t;return(t=new this).fromForm.apply(t,arguments)},r.recordsValues=function(){var t,r,e,n;r=[],n=this.records;for(t in n)e=n[t],r.push(e);return r},r.cloneArray=function(t){var r,e,n,i;for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(r.clone());return i},r.prototype.newRecord=!0,r.prototype.isNew=function(){return this.newRecord},r.prototype.isValid=function(){return!this.validate()},r.prototype.validate=function(){},r.prototype.load=function(t){var r,e;for(r in t)e=t[r],"function"==typeof this[r]?this[r](e):this[r]=e;return this},r.prototype.attributes=function(){var t,r,e,n,i;for(r={},i=this.constructor.attributes,e=0,n=i.length;n>e;e++)t=i[e],t in this&&("function"==typeof this[t]?r[t]=this[t]():r[t]=this[t]);return this.id&&(r.id=this.id),r},r.prototype.eql=function(t){var r,e;return t&&t.constructor===this.constructor&&(t.id===this.id||(r=this.id,f.call(t.ids,r)>=0)||(e=t.id,f.call(this.ids,e)>=0))},r.prototype.save=function(){var t,r;return(t=this.validate())?(this.trigger("error",t),!1):(this.trigger("beforeSave"),r=this.newRecord?this.create():this.update(),this.trigger("save"),r)},r.prototype.updateAttribute=function(t,r){return this[t]=r,this.save()},r.prototype.updateAttributes=function(t){return this.load(t),this.save()},r.prototype.changeID=function(t){var r;return this.ids.push(this.id),r=this.constructor.records,r[t]=r[this.id],delete r[this.id],this.id=t,this.save()},r.prototype.destroy=function(){return this.trigger("beforeDestroy"),delete this.constructor.records[this.id],this.destroyed=!0,this.trigger("destroy"),this.trigger("change","destroy"),this.unbind(),this},r.prototype.dup=function(t){var r;return r=new this.constructor(this.attributes()),t===!1?r.newRecord=this.newRecord:delete r.id,r},r.prototype.clone=function(){return Object.create(this)},r.prototype.reload=function(){var t;return this.newRecord?this:(t=this.constructor.find(this.id),this.load(t.attributes()),t)},r.prototype.toJSON=function(){return this.attributes()},r.prototype.toString=function(){return"<"+this.constructor.className+" ("+JSON.stringify(this)+")>"},r.prototype.fromForm=function(r){var e,n,i,s,o;for(n={},o=t(r).serializeArray(),i=0,s=o.length;s>i;i++)e=o[i],n[e.name]=e.value;return this.load(n)},r.prototype.exists=function(){return this.id&&this.id in this.constructor.records},r.prototype.update=function(){var t,r;return this.trigger("beforeUpdate"),r=this.constructor.records,r[this.id].load(this.attributes()),t=r[this.id].clone(),t.trigger("update"),t.trigger("change","update"),t},r.prototype.create=function(){var t,r;return this.trigger("beforeCreate"),this.id||(this.id=u()),this.newRecord=!1,r=this.constructor.records,r[this.id]=this.dup(!1),t=r[this.id].clone(),t.trigger("create"),t.trigger("change","create"),t},r.prototype.bind=function(t,r){var e,n;return this.constructor.bind(t,e=d(function(t){return t&&this.eql(t)?r.apply(this,arguments):void 0},this)),this.constructor.bind("unbind",n=d(function(r){return r&&this.eql(r)?(this.constructor.unbind(t,e),this.constructor.unbind("unbind",n)):void 0},this)),e},r.prototype.trigger=function(){var t,r;return t=1<=arguments.length?p.call(arguments,0):[],t.splice(1,0,this),(r=this.constructor).trigger.apply(r,t)},r.prototype.unbind=function(){return this.trigger("unbind")},r}(),r=function(){function r(e){this.release=d(this.release,this);var n,i,s;this.options=e,s=this.options;for(n in s)i=s[n],this[n]=i;this.el||(this.el=document.createElement(this.tag)),this.el=t(this.el),this.className&&this.el.addClass(this.className),this.release(function(){return this.el.remove()}),this.events||(this.events=this.constructor.events),this.elements||(this.elements=this.constructor.elements),this.events&&this.delegateEvents(),this.elements&&this.refreshElements(),r.__super__.constructor.apply(this,arguments)}return y(r,s),r.include(e),r.include(n),r.prototype.eventSplitter=/^(\S+)\s*(.*)$/,r.prototype.tag="div",r.prototype.release=function(t){return"function"==typeof t?this.bind("release",t):this.trigger("release")},r.prototype.$=function(r){return t(r,this.el)},r.prototype.delegateEvents=function(){var t,r,e,n,i,s,o;s=this.events,o=[];for(r in s)n=s[r],"function"!=typeof n&&(n=this.proxy(this[n])),e=r.match(this.eventSplitter),t=e[1],i=e[2],o.push(""===i?this.el.bind(t,n):this.el.delegate(i,t,n));return o},r.prototype.refreshElements=function(){var t,r,e,n;e=this.elements,n=[];for(t in e)r=e[t],n.push(this[r]=this.$(t));return n},r.prototype.delay=function(t,r){return setTimeout(this.proxy(t),r||0)},r.prototype.html=function(t){return this.el.html(t.el||t),this.refreshElements(),this.el},r.prototype.append=function(){var t,r,e;return r=1<=arguments.length?p.call(arguments,0):[],r=function(){var e,n,i;for(i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.el||t);return i}(),(e=this.el).append.apply(e,r),this.refreshElements(),this.el},r.prototype.appendTo=function(t){return this.el.appendTo(t.el||t),this.refreshElements(),this.el},r.prototype.prepend=function(){var t,r,e;return r=1<=arguments.length?p.call(arguments,0):[],r=function(){var e,n,i;for(i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.el||t);return i}(),(e=this.el).prepend.apply(e,r),this.refreshElements(),this.el},r.prototype.replace=function(t){var r,e;return e=[this.el,t.el||t],r=e[0],this.el=e[1],r.replaceWith(this.el),this.delegateEvents(),this.refreshElements(),this.el},r}(),t=this.jQuery||this.Zepto||function(t){return t},"function"!=typeof Object.create&&(Object.create=function(t){var r;return r=function(){},r.prototype=t,new r}),c=function(t){return"[object Array]"===Object.prototype.toString.call(t)},h=function(t){var r;if(!t)return!0;for(r in t)return!1;return!0},a=function(t){return Array.prototype.slice.call(t,0)},u=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r,e;return r=16*Math.random()|0,e="x"===t?r:3&r|8,e.toString(16)}).toUpperCase()},o=this.Spine={},"undefined"!=typeof module&&null!==module&&(module.exports=o),o.version="1.0.3",o.isArray=c,o.isBlank=h,o.$=t,o.Events=e,o.Log=n,o.Module=s,o.Controller=r,o.Model=i,s.extend.call(o,e),s.create=s.sub=r.create=r.sub=i.sub=function(t,r){var e;return e=function(){function t(){t.__super__.constructor.apply(this,arguments)}return y(t,this),t}.call(this),t&&e.include(t),r&&e.extend(r),"function"==typeof e.unbind&&e.unbind(),e},i.setup=function(t,r){var e;return null==r&&(r=[]),e=function(){function t(){t.__super__.constructor.apply(this,arguments)}return y(t,this),t}.call(this),e.configure.apply(e,[t].concat(p.call(r))),e},s.init=r.init=i.init=function(t,r,e,n,i){return new this(t,r,e,n,i)},o.Class=s}).call(this);