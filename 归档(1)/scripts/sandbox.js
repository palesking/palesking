(function(){var t,n,e=function(t,n){return function(){return t.apply(n,arguments)}};t=function(){function t(t){this.sandboxSelector=t,this.checkSandbox=e(this.checkSandbox,this),this.ready=!1,this.msgTable={},this.sandbox=$(this.sandboxSelector).get(0)}return t.prototype.register=function(){return window.addEventListener("message",function(t){return function(n){var e,o,s;return e=n.data.id,o=n.data.result,s=n.data.state,t.msgTable.hasOwnProperty(e)?(0===s?t.msgTable[e](o):console.log("error #"+s+": "+o),delete t.msgTable[e]):void 0}}(this)),this.checkSandbox()},t.prototype.checkSandbox=function(){return this.ready?void 0:(this.mandate("ok?",null,function(t){return function(n){return t.ready=!0}}(this)),setTimeout(this.checkSandbox,100))},t.prototype.s4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},t.prototype.mandate=function(t,n,e){var o;return o=this.s4(),this.msgTable[o]=e,this.postMessage(o,t,n)},t.prototype.postMessage=function(t,n,e){var o;return o={id:t,cmd:n,context:e},this.sandbox.contentWindow?this.sandbox.contentWindow.postMessage(o,"*"):void 0},t}(),n="undefined"!=typeof exports&&null!==exports?exports:self,n.SandBoxCtrl=t}).call(this);